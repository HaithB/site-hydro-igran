<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Final - Hydro Igran</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <link rel="stylesheet" href="dashboard.css">
</head>
<body class="dashboard-body">
    
    <aside class="sidebar">
        <a href="dashboard.html" class="sidebar-logo-link">
            <div class="sidebar-header">
                <h1 class="logo-text">Hydro Igran</h1>
            </div>
        </a>
        <nav class="sidebar-nav">
            <a href="#" class="active"><i class="fa-solid fa-table-cells-large"></i> Vue Salle</a>
            <a href="ligne.html"><i class="fa-solid fa-chart-simple"></i> Vue Ligne</a>
            <a href="bac.html"><i class="fa-solid fa-box"></i> Vue Bac</a>
            <a href="alertes.html"><i class="fa-solid fa-bell"></i> Alertes</a>
            <a href="economie.html"><i class="fa-solid fa-arrow-trend-up"></i> Économie</a>
        </nav>
        <a href="#" class="logout"><i class="fa-solid fa-right-from-bracket"></i> Déconnexion</a>
    </aside>

    <div class="sidebar-overlay"></div>

    <main class="main-content">
        <section class="hero-section">
            <div class="hero-header">
                <button class="mobile-menu-toggle" aria-label="Ouvrir le menu"><i class="fa-solid fa-bars"></i></button>
                <h1 class="main-title">Vue d'Ensemble de la Salle</h1>
                <div class="header-actions">
                    <div id="datetime-container" class="header-item"></div>
                    <div class="header-item"><i class="fa-regular fa-bell"></i></div>
                    <div class="header-item"><span>Salle</span><i class="fa-solid fa-chevron-down fa-xs"></i></div>
                    <div class="header-item user-profile">
                        <img src="/assets/story/h_pdp.jpg" alt="Avatar de l'utilisateur">
                        <span>Haithem Chouari</span>
                    </div>
                </div>
            </div>

            <div class="main-kpi-wrapper">
                <div class="main-kpi">
                    <h3 class="kpi-title">Production Totale</h3>
                    <p class="kpi-value">
                        <span class="counter" data-target="0" data-counter-id="productionTotale">0</span>
                        <span class="kpi-unit">kg/jour</span>
                    </p>
                    <div class="kpi-chart"><canvas id="productionTotalChart"></canvas></div>
                </div>
            </div>
        </section>

        <section class="dashboard-grid">
            <article class="card kpi-summary-card"><i class="fa-solid fa-chart-pie kpi-summary-icon"></i><div><h4 class="card-title">Taux d'Occupation</h4><p class="kpi-summary-value"><span class="counter" data-target="0" data-counter-id="tauxOccupation">0</span>%</p></div></article>
            <article class="card kpi-summary-card"><i class="fa-solid fa-droplet kpi-summary-icon"></i><div><h4 class="card-title">Consommation Eau</h4><p class="kpi-summary-value"><span class="counter" data-target="0" data-counter-id="consoEau">0</span> L/kg</p></div></article>
            <article class="card kpi-summary-card"><i class="fa-solid fa-rocket kpi-summary-icon"></i><div><h4 class="card-title">Performance Globale</h4><p class="kpi-summary-value"><span class="counter" data-target="0" data-counter-id="performance">0</span>/100</p></div></article>
            <article class="card kpi-summary-card"><i class="fa-solid fa-hand-holding-droplet kpi-summary-icon"></i><div><h4 class="card-title">Efficacité Hydrique</h4><p class="kpi-summary-value"><span id="efficacite-hydrique">0</span><small>%</small></p></div></article>
            <article class="card kpi-summary-card"><i class="fa-solid fa-bolt kpi-summary-icon"></i><div><h4 class="card-title">Efficacité Énergétique</h4><p class="kpi-summary-value"><span id="efficacite-energetique">0</span><small> kWh/kg</small></p></div></article>
             <article class="card kpi-summary-card"><i class="fa-solid fa-tag kpi-summary-icon"></i><div><h4 class="card-title">Coût de Revient</h4><p class="kpi-summary-value"><span id="cout-revient">0</span><small> dh/kg</small></p></div></article>

            <article class="card card--dark large-span-2">
                <div class="card-header"><h3 class="card-title">Production des 30 derniers jours</h3></div>
                <div class="chart-container"><canvas id="production30DaysChart"></canvas></div>
            </article>
            <article class="card large-span-1">
                 <div class="card-header"><h3 class="card-title">Consommation Hebdomadaire</h3></div>
                 <div class="chart-container"><canvas id="consommationChart"></canvas></div>
                 <div class="chart-legend">
                    <div class="legend-item"><span class="color-dot" style="background-color: var(--dark-blue);"></span> PÔME</div>
                    <div class="legend-item"><span class="color-dot" style="background-color: var(--medium-gray);"></span> Étiage</div>
                    <div class="legend-item"><span class="color-dot" style="background-color: var(--primary-green);"></span> Énergie</div>
                </div>
            </article>

            <article class="card">
                <h3 class="card-title">Climat & Environnement</h3>
                <div class="climat-grid">
                    <div class="data-point"><i class="fa-solid fa-temperature-half"></i><div><strong>Température</strong><span id="valeur-temperature">0°C</span></div></div>
                    <div class="data-point"><i class="fa-solid fa-droplet"></i><div><strong>Humidité</strong><span id="valeur-humidite">0%</span></div></div>
                    <div class="data-point"><i class="fa-solid fa-smog"></i><div><strong>CO₂</strong><span id="valeur-co2">0 ppm</span></div></div>
                    <div class="data-point"><i class="fa-solid fa-sun"></i><div><strong>Éclairage</strong><span id="etat-eclairage">0/0 h</span></div></div>
                </div>
            </article>
            <article class="card">
                <h3 class="card-title">Solution Nutritive (Master Tank)</h3>
                <ul class="ressources-list">
                    <li><span><i class="fa-solid fa-faucet-drip"></i> Réservoir Eau</span><div class="progress-bar-container"><div id="barre-eau" class="progress-bar">0%</div></div></li>
                    <li><span><i class="fa-solid fa-fill-drip"></i> Réservoir Solution</span><div class="progress-bar-container"><div id="barre-solution" class="progress-bar">0%</div></div></li>
                    <li><span><i class="fa-solid fa-wave-square"></i> EC</span><strong id="valeur-ec">0 mS/cm</strong></li>
                    <li><span><i class="fa-solid fa-flask-vial"></i> pH</span><strong id="valeur-ph">0</strong></li>
                </ul>
            </article>
            <article class="card">
                <h3 class="card-title">Énergie & Hygiène</h3>
                <ul class="ressources-list">
                    <li><span><i class="fa-solid fa-plug-circle-check"></i> Conso. Énergétique (24h)</span><strong id="conso-energie">0 kWh</strong></li>
                    <li><span><i class="fa-solid fa-shield-halved"></i> État Sanitaire</span><strong id="etat-sanitaire" class="status-badge">...</strong></li>
                    <li><span><i class="fa-solid fa-calendar-check"></i> Prochain Nettoyage</span><strong id="prochain-nettoyage">...</strong></li>
                </ul>
            </article>

            <article class="card table-card large-span-3">
                 <h3 class="card-title">Statut des Lignes de Production</h3>
                 <table class="production-table">
                     <thead><tr><th>Ligne</th><th>Statut</th><th>pH/EC</th><th>Température</th><th>Proch. Récolte</th></tr></thead>
                     <tbody>
                        <tr><td>Ligne 1</td><td><span class="status-badge status-ok">OK</span></td><td>6.8</td><td>22°C</td><td>31 min</td></tr>
                        <tr><td>Ligne 2</td><td><span class="status-badge status-warn">Ajuster</span></td><td>3.5</td><td>28°C</td><td>40 min</td></tr>
                        <tr><td>Ligne 3</td><td><span class="status-badge status-ok">OK</span></td><td>4.5</td><td>28°C</td><td>40 min</td></tr>
                        <tr><td>Ligne 4</td><td><span class="status-badge status-warn">Ajuster</span></td><td>1.2</td><td>31°C</td><td>42 min</td></tr>
                        <tr><td>Ligne 5</td><td><span class="status-badge status-ok">OK</span></td><td>0.8</td><td>32°C</td><td>38 min</td></tr>
                     </tbody>
                 </table>
            </article>
        </section>
    </main>
    
    <script src="dashboard.js"></script>
</body>
</html>