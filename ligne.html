<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vue Ligne - Hydro Igran Dashboard</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="icon" href="assets/index/icon.png" type="image/png">

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="dashboard.css">
</head>
<body class="dashboard-body">
    
    <aside class="sidebar">
        <a href="dashboard.html" class="sidebar-logo-link">
            <div class="sidebar-header">
                <div class="logo-text">Hydro Igran</div>
            </div>
        </a>
        <nav class="sidebar-nav">
            <a href="dashboard.html"><i class="fa-solid fa-table-cells-large"></i> Vue Salle</a>
            <a href="ligne.html" class="active"><i class="fa-solid fa-chart-simple"></i> Vue Ligne</a>
            <a href="bac.html"><i class="fa-solid fa-box"></i> Vue Bac</a>
            <a href="alertes.html"><i class="fa-solid fa-bell"></i> Alertes</a>
            <a href="economie.html"><i class="fa-solid fa-arrow-trend-up"></i> Économie</a>
        </nav>

        <div class="theme-switcher">
            <h4>Thèmes</h4>
            <div class="theme-buttons">
                <button class="theme-button" data-theme="acier" style="--color: #34A853;" aria-label="Thème Acier & Chlorophylle"></button>
                <button class="theme-button" data-theme="carbone" style="--color: #34D399;" aria-label="Thème Carbone & Néon"></button>
                <button class="theme-button" data-theme="sable" style="--color: #15803D;" aria-label="Thème Sable & Oasis"></button>
                <button class="theme-button" data-theme="menthe" style="--color: #05C793;" aria-label="Thème Ardoise & Menthe"></button>
            </div>
        </div>

        <a href="index.html" class="logout"><i class="fa-solid fa-right-from-bracket"></i> Déconnexion</a>
    </aside>

    <div class="sidebar-overlay"></div>

    <main class="main-content">

        <!-- REMPLACEZ L'ANCIEN HEADER PAR CELUI-CI -->
        <header class="page-header">
            <button class="mobile-menu-toggle" aria-label="Ouvrir le menu"><i class="fa-solid fa-bars"></i></button>

            <!-- Titre et sélecteur regroupés à gauche -->
            <div class="header-title-wrapper">
                <h1 class="main-title">Détail de la Ligne</h1>
                <div class="line-selector-wrapper">
                    <i class="fa-solid fa-layer-group"></i>
                    <select id="line-selector" class="dropdown-line-selector">
                        <option value="1">Ligne 1</option>
                        <option value="2">Ligne 2</option>
                        <option value="3">Ligne 3</option>
                        <option value="4">Ligne 4</option>
                        <option value="5">Ligne 5</option>
                    </select>
                </div>
            </div>

            <!-- Actions regroupées à droite, comme sur la page d'accueil -->
            <div class="header-actions">
                <div id="datetime-container" class="header-item"></div>
                <div class="header-item"><i class="fa-regular fa-bell"></i></div>
                <div class="header-item user-profile">
                    <img src="/assets/story/a-m_pdp2.png" alt="Avatar de l'utilisateur">
                    <span>Invité </span>
                </div>
            </div>
        </header>

        <!-- NOUVELLE GRILLE DE MISE EN PAGE -->
        <section class="line-view-grid">
            <!-- COLONNE DE GAUCHE : LE GRAPHIQUE CENTRAL -->
            <article class="card card--dark main-growth-card">
                <div class="card-header">
                    <h3 class="card-title">Courbe de Croissance (Poids estimé)</h3>
                    <div class="current-age">Jour 7 / 7</div>
                </div>
                <div class="chart-container"><canvas id="growthChart"></canvas></div>
            </article>

            <!-- COLONNE DE DROITE : LES DONNÉES CLÉS -->
            <div class="right-column-grid">
                <article class="card">
                    <h3 class="card-title">Lot en cours</h3>
                    <ul class="details-list">
                        <li><span>Stade</span><strong>Verdissement</strong></li>
                        <li><span>Densité semis</span><strong>7.5 kg/m²</strong></li>
                        <li><span>Rendement estimé</span><strong>84 kg</strong></li>
                    </ul>
                </article>
                <article class="card">
                    <h3 class="card-title">Conditions de Culture</h3>
                    <div class="conditions-grid">
                        <div class="data-point-small"><i class="fa-solid fa-temperature-half"></i><div><strong>T° Air</strong><span>21.8°C</span></div></div>
                        <div class="data-point-small"><i class="fa-solid fa-droplet"></i><div><strong>HR%</strong><span>66%</span></div></div>
                        <div class="data-point-small"><i class="fa-solid fa-seedling"></i><div><strong>T° Substrat</strong><span>20.7°C</span></div></div>
                        <div class="data-point-small"><i class="fa-solid fa-sun"></i><div><strong>Éclairage</strong><span>14/14h</span></div></div>
                    </div>
                </article>
            </div>
            
            <!-- PLEINE LARGEUR : AUTRES DONNÉES IMPORTANTES -->
            <article class="card">
                <h3 class="card-title">Consommation & Ressources (Ligne)</h3>
                <div class="ressources-line-grid">
                    <div><span><i class="fa-solid fa-tint"></i> Conso. Eau (24h)</span><strong>7.5 L</strong></div>
                    <div><span><i class="fa-solid fa-faucet"></i> Débit Arrosage</span><strong>0.9 L/min</strong></div>
                    <div><span><i class="fa-solid fa-recycle"></i> Solution Drainée</span><strong>1.2 L</strong></div>
                    <div><span><i class="fa-solid fa-bolt"></i> Conso. Énergie (24h)</span><strong>4.2 kWh</strong></div>
                </div>
            </article>

            <article class="card">
                <h3 class="card-title">Santé & Risques</h3>
                <div class="health-grid">
                    <div class="health-item">
                        <div class="health-label">Indice Fongique</div>
                        <div class="health-gauge-container">
                            <div class="health-gauge" style="--value: 28;"></div>
                            <span>28%</span>
                        </div>
                        <div class="health-status low">Bas</div>
                    </div>
                    <div class="health-item">
                        <div class="health-label">Homogénéité</div>
                        <div class="health-gauge-container">
                            <div class="health-gauge" style="--value: 92;"></div>
                            <span>92%</span>
                        </div>
                        <div class="health-status high">Élevée</div>
                    </div>
                    <div class="health-item">
                        <div class="health-label">Taux de Pertes</div>
                        <div class="health-gauge-container">
                            <div class="health-gauge reverse" style="--value: 4;"></div>
                            <span>4%</span>
                        </div>
                        <div class="health-status low">Bas</div>
                    </div>
                    <div class="health-item">
                         <div class="health-label">Dernière Désinfection</div>
                         <div class="last-op">Il y a <strong>8 jours</strong></div>
                    </div>
                </div>
            </article>

                <!-- ==========================================================================
                BLOC À AJOUTER : NOUVELLES CARTES TECHNIQUES
                ========================================================================== -->

            <!-- LIGNE SUPPLÉMENTAIRE : ÉTAT DES RÉSERVOIRS ET PARAMÈTRES DE CONTRÔLE -->
            <article class="card">
                <h3 class="card-title">État des Réservoirs (Ligne)</h3>
                <div class="tank-status-grid">
                    <div class="tank-item">
                        <div class="tank-label">
                            <i class="fa-solid fa-flask"></i>
                            <span>Nutriments (N)</span>
                        </div>
                        <div class="progress-bar-container">
                            <div class="progress-bar" style="width: 75%;">75%</div>
                        </div>
                    </div>
                    <div class="tank-item">
                        <div class="tank-label">
                            <i class="fa-solid fa-arrow-up"></i>
                            <span>pH Up</span>
                        </div>
                        <div class="progress-bar-container">
                            <div class="progress-bar" style="width: 60%;">60%</div>
                        </div>
                    </div>
                    <div class="tank-item">
                        <div class="tank-label">
                            <i class="fa-solid fa-arrow-down"></i>
                            <span>pH Down</span>
                        </div>
                        <div class="progress-bar-container">
                            <div class="progress-bar" style="width: 80%;">80%</div>
                        </div>
                    </div>
                </div>
            </article>

            <article class="card">
                <h3 class="card-title">Paramètres de Contrôle Automatique</h3>
                <ul class="details-list">
                    <li><span>État de la Pompe</span><strong class="status-ok"><i class="fa-solid fa-power-off"></i> ON</strong></li>
                    <li><span>Régulateur Humidité</span><strong>Actif</strong></li>
                    <li><span>Ventilation</span><strong>Active</strong></li>
                </ul>
            </article>

            <article class="card">
                <h3 class="card-title">Valeurs Globales (Ligne)</h3>
                <div class="global-values-grid">
                    <div class="global-value-item">
                        <span>EC</span>
                        <strong>0.6 mS/cm</strong>
                    </div>
                    <div class="global-value-item">
                        <span>pH</span>
                        <strong>6.5</strong>
                    </div>
                </div>
            </article>

            <!-- LIGNE SUPPLÉMENTAIRE : HISTORIQUE ET JOURNAL -->
            <article class="card large-span-2">
                <h3 class="card-title">Historique pH & EC (24h)</h3>
                <div class="chart-container" style="height: 280px;"><canvas id="phEcLineChart"></canvas></div>
            </article>

            <article class="card large-span-1">
                <h3 class="card-title">Journal d'Événements</h3>
                <ul class="event-log">
                    <li>
                        <i class="fa-solid fa-droplet event-icon"></i>
                        <div class="event-details">
                            <p>Ajout 50ml pH down</p>
                            <small>Aujourd'hui, 10:12</small>
                        </div>
                    </li>
                    <li>
                        <i class="fa-solid fa-arrows-spin event-icon"></i>
                        <div class="event-details">
                            <p>Cycle d'irrigation terminé</p>
                            <small>Aujourd'hui, 09:30</small>
                        </div>
                    </li>
                    <li>
                        <i class="fa-solid fa-wrench event-icon"></i>
                        <div class="event-details">
                            <p>Calibration sonde pH</p>
                            <small>Hier, 14:00</small>
                        </div>
                    </li>
                    <li>
                        <i class="fa-solid fa-triangle-exclamation event-icon alert"></i>
                        <div class="event-details">
                            <p>Alerte : Température haute</p>
                            <small>Hier, 18:30</small>
                        </div>
                    </li>
                </ul>
            </article>
            
        </section>
    </main>
    
    <script src="dashboard.js"></script>
</body>
</html>